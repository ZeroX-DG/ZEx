const Table = require('cli-table');
const crypto = require('crypto');
let hashes = crypto.getHashes();

function display_all_hash(){
	let table = new Table({
	    head: ['Hashes'],
	    style: {head: ['cyan'], border: ['cyan']}
	});
	
	for(let i = 0; i < hashes.length; i++){
		table.push([hashes[i]]);
	}

	console.log(table.toString());
}

function main(){
	if(arguments.length == 2){
		// text and hash
		let hash = arguments[1];
		let text = arguments[0];
		if(hashes.indexOf(hash) != -1){
			let result = crypto.createHash(hash).update(text).digest("hex");
			console.log("[*] Result: " + result);
		}
		else{
			console.log("Hash doesn't exits, run all for list hashes");
		}
	}
	else{
		// show all
		display_all_hash();
	}
}

module.exports = main;